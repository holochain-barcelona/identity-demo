(window["webpackJsonpidentity-manager"]=window["webpackJsonpidentity-manager"]||[]).push([[0],{132:function(e,t,n){e.exports=n(185)},185:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(10),s=n(27),i=n(7),l=n(8),c=n(48),p=n(261),u=n(235),d=n(267),f=n(264),m=n(189),h=n(43),g=n.n(h),y=n(243),b=n(187),v=n(246),O=n(247),E=n(114),P=n.n(E),j=n(262),S=n(39),k=n(186),C=n(47),w=n(18),A=n(13),D=n(20),N=n(21),_=n(22),T=n(234),R=n(107),x=n.n(R),K=n(115),F=Object(K.a)({palette:{primary:{main:"#556cd6"},secondary:{main:"#19857b"},error:{main:x.a.A400},background:{default:"#fff"}}});var I=function(e){return function(t){return r.a.createElement(T.a,{theme:F},r.a.createElement(u.a,null),r.a.createElement(e,t))}},H=n(266),z=n(5),L=n(245),M=n(263),B=n(237),U=n(244),Z=n(240),q=n(239);function W(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function V(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?W(n,!0).forEach(function(t){Object(l.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):W(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var Y=function(e){function t(e){var n;return Object(w.a)(this,t),(n=Object(D.a)(this,Object(N.a)(t).call(this,e))).handleSubmit=function(){n.props.login(n.state.login),n.props.history.push("/")},n.state={login:{email:"",password:""}},n}return Object(_.a)(t,e),Object(A.a)(t,[{key:"updateEmail",value:function(e){this.setState({login:V({},this.state.login,{email:e})})}},{key:"updatePassword",value:function(e){this.setState({login:V({},this.state.login,{password:e})})}},{key:"render",value:function(){var e=this,t=this.props.classes;return a.createElement("div",{className:t.root},a.createElement(B.a,{className:t.card},a.createElement(q.a,{component:"img",alt:"Holo Logo",height:"240",image:"holo-dots.png",title:"Holo Logo"}),a.createElement(Z.a,null,a.createElement(S.a,{gutterBottom:!0,variant:"h5",component:"h2"},"Generate Your Holo Keys"),a.createElement(S.a,{variant:"body2",color:"textSecondary",component:"p"},"Welcome to the Agent Centric Web where you are in control of your personal data. Use the same email password combination to access all of your Holo Apps and keep your personal data safe and private."),a.createElement("div",null,a.createElement(M.a,{name:"email",value:this.state.login.email,onChange:function(t){return e.updateEmail(t.target.value)},label:"Email"}),a.createElement(M.a,{name:"password",value:this.state.login.password,onChange:function(t){return e.updatePassword(t.target.value)},label:"Password"}))),a.createElement(U.a,null,a.createElement(L.a,{name:"submit",onClick:function(){return e.handleSubmit()},color:"primary"},"Log In"))))}}]),t}(a.Component),G=I(Object(z.a)(function(e){var t=e.palette;return Object(H.a)({root:{display:"flex",flexDirection:"column",backgroundColor:t.background.default,color:t.primary.main}})})(Object(c.e)(Y))),J=n(12),X=Object(J.createHolochainZomeCallAsyncAction)("personas-profiles","login","login"),$=Object(s.b)(function(){return{title:"Login"}},function(e){return{login:function(t){return e(X.create({spec:t}))}}})(G),Q=n(84),ee=n(70),te=n.n(ee),ne=function(e){function t(){return Object(w.a)(this,t),Object(D.a)(this,Object(N.a)(t).apply(this,arguments))}return Object(_.a)(t,e),Object(A.a)(t,[{key:"componentDidMount",value:function(){console.log("get personas"),this.props.getPersonas()}},{key:"render",value:function(){var e=this.props,t=e.classes,n=e.personas;return a.createElement("div",{className:t.root},a.createElement(Q.a,{className:t.paper},a.createElement(S.a,{variant:"h4"},"Personas"),a.createElement(S.a,{variant:"body1",gutterBottom:!0},"Look after your personal information here, click on a Persona to update or click Add Persona to create a new one."),a.createElement(y.a,{id:"personas",component:"nav"},n.map(function(e,t){return a.createElement(c.a,{key:t,render:function(n){var r=n.history;return a.createElement(b.a,{key:t,id:e.hash,button:!0,onClick:function(){r.push("/persona/".concat(e.name))}},a.createElement(v.a,null,a.createElement(g.a,null)),a.createElement(O.a,{primary:e.name}))}})})),a.createElement(c.a,{render:function(e){var t=e.history;return a.createElement(L.a,{name:"addPersona",color:"primary",onClick:function(){t.push("/persona/new")}},a.createElement(te.a,null),"Add Persona")}})))}}]),t}(a.Component),ae=I(Object(z.a)(function(e){var t=e.spacing,n=e.palette;return Object(H.a)({root:{width:"100%",backgroundColor:n.background.paper},paper:{padding:t(1)}})})(Object(c.e)(ne))),re=n(25),oe=Object(J.createHolochainZomeCallAsyncAction)("personas-profiles","personas","create_persona"),se=Object(J.createHolochainZomeCallAsyncAction)("personas-profiles","personas","update_persona"),ie=Object(J.createHolochainZomeCallAsyncAction)("personas-profiles","personas","delete_persona"),le=Object(J.createHolochainZomeCallAsyncAction)("personas-profiles","personas","get_personas"),ce=Object(J.createHolochainZomeCallAsyncAction)("personas-profiles","personas","add_field"),pe=Object(J.createHolochainZomeCallAsyncAction)("personas-profiles","profiles","get_profiles"),ue=Object(J.createHolochainZomeCallAsyncAction)("personas-profiles","profiles","create_mapping"),de=Object(re.createAction)("holo-vault/SET_CURRENT_PERSONA",function(e){return function(t){return e(t)}}),fe=Object(re.createAction)("holo-vault/SET_CURRENT_PROFILE",function(e){return function(t){return e(t)}}),me=Object(s.b)(function(e){return{personas:e.personasProfiles.profile.personas}},function(e){return{getPersonas:function(){return e(le.create({}))}}})(ae),he=n(23),ge=n(110),ye=n.n(ge),be=n(109),ve=n.n(be),Oe=n(248),Ee=n(249),Pe=n(253),je=n(251),Se=n(252),ke=n(250);function Ce(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function we(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ce(n,!0).forEach(function(t){Object(l.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ce(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Ae(e){return a.createElement("div",null,a.createElement(M.a,{name:"fieldName".concat(e.index),label:"Field Name",value:e.field.name,onChange:function(t){return n=t.target.value,void e.onChange(we({},e.field,{name:n}));var n}}),a.createElement(M.a,{name:"fieldValue".concat(e.index),label:"Field Value",value:e.field.data,onChange:function(t){return n=t.target.value,void e.onChange(we({},e.field,{data:n}));var n}}))}var De,Ne=function(e){function t(e){var n;return Object(w.a)(this,t),(n=Object(D.a)(this,Object(N.a)(t).call(this,e))).handleSubmit=function(){var e={name:n.state.persona.name},t=n.state.persona.fields;""===n.state.persona.hash?n.props.create(e,t).then(n.props.getPersonas).catch(function(e){return console.log(e)}):n.props.update(n.state.persona.hash,e,t).then(n.props.getPersonas).catch(function(e){return console.error(e)}),n.props.history.push("/personas")},n.handleConfirmDelete=function(){n.setState({open:!0})},n.handleDelete=function(){n.setState({open:!1}),n.props.delete(n.state.persona.hash).then(n.props.getPersonas).catch(function(e){return console.error(e)}),n.props.history.push("/personas")},n.handleCloseDialog=function(){n.setState({open:!1})},n.handleAddPersonaField=function(){n.setState({persona:we({},n.state.persona,{fields:[].concat(Object(he.a)(n.state.persona.fields),[{name:"",data:""}])})})},n.state={open:!1,persona:{name:"",hash:"",fields:[]}},n}return Object(_.a)(t,e),Object(A.a)(t,[{key:"componentDidMount",value:function(){this.props.getPersonas({}).catch(function(e){return console.log(e)}),this.setState({open:!1,persona:this.props.currentPersona})}},{key:"updateField",value:function(e,t){var n=this.state.persona.fields;this.setState({persona:we({},this.state.persona,{fields:[].concat(Object(he.a)(n.slice(0,t)),[e],Object(he.a)(n.slice(t+1)))})})}},{key:"updateName",value:function(e){this.setState({persona:we({},this.state.persona,{name:e})})}},{key:"render",value:function(){var e=this,t=this.props.classes;return this.state.persona?a.createElement("div",{className:t.root},a.createElement(Q.a,{className:t.paper},a.createElement(S.a,{variant:"h4"},"Manage Your Personas"),a.createElement(S.a,{variant:"body1",gutterBottom:!0},"You can add a new Persona and add as many fields to it as you like. You will probably have a *Default*, *Work* and a *Friends* persona."),a.createElement("div",null,a.createElement(M.a,{name:"personaName",value:this.state.persona.name,onChange:function(t){return e.updateName(t.target.value)},label:"Persona Name"})),this.state.persona.fields.map(function(t,n){return a.createElement(Ae,{key:n,index:n,field:t,onChange:function(t){return e.updateField(t,n)}})}),a.createElement(L.a,{name:"addField",color:"primary",onClick:this.handleAddPersonaField},a.createElement(ve.a,null),"Add Field"),a.createElement(L.a,{name:"submitPersona",color:"primary",onClick:function(){return e.handleSubmit()}},a.createElement(te.a,null),""===this.state.persona.hash?"Create Persona":"Update Persona"),a.createElement(L.a,{name:"deletePersona",color:"primary",onClick:function(){return e.handleConfirmDelete()}},a.createElement(ye.a,null),"Delete Persona"),a.createElement(Ee.a,{open:this.state.open,onClose:this.handleCloseDialog},a.createElement(ke.a,{id:"alert-dialog-slide-title"},"Delete ",this.state.persona.name," Persona?"),a.createElement(je.a,null,a.createElement(Se.a,null,"Agreeing will delete this Persona.")),a.createElement(Pe.a,null,a.createElement(L.a,{onClick:this.handleCloseDialog,color:"primary"},"Cancel"),a.createElement(L.a,{id:"Agree",onClick:this.handleDelete,color:"primary"},"Delete"))))):a.createElement("div",null,a.createElement(Oe.a,null))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return t.persona?null:{persona:e.currentPersona}}}]),t}(a.Component),_e=I(Object(z.a)(function(e){var t=e.spacing;return Object(H.a)({root:{textAlign:"left",paddingTop:t(1)},button:{marginRight:t(1),marginTop:t(1)},paper:{padding:t(1)}})})(Object(c.e)(Ne))),Te=Object(s.b)(function(e,t){var n,a=t.match.params.name;return n="new"===a?{name:"",hash:"",fields:[]}:e.personasProfiles.profile.personas.filter(function(e){return a===e.name})[0],{title:"Persona - ".concat(a),currentPersona:n,personas:e.personasProfiles.profile.personas}},function(e){return{getPersonas:function(){return e(le.create({}))},create:function(t,n){return e(oe.create({spec:t})).then(function(t){return Promise.all(n.map(function(n){return e(ce.create({persona_address:t,field:n}))}))})},update:function(t,n,a){return e(se.create({persona_address:t,spec:n})).then(function(t){return Promise.all(a.map(function(n){return e(ce.create({persona_address:t,field:n}))}))})},delete:function(t){return e(ie.create({persona_address:t}))}}})(_e),Re=n(2),xe=n(265),Ke=n(255),Fe=n(256),Ie=n(254),He=n(71),ze=n.n(He);!function(e){e.STORE="STORE",e.DISPLAY="DISPLAY"}(De||(De={}));var Le=n(268),Me=n(112),Be=n.n(Me),Ue=n(113),Ze=n.n(Ue);function qe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function We(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?qe(n,!0).forEach(function(t){Object(l.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):qe(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var Ve=n(92),Ye=n(93),Ge=[];function Je(e,t){var n=t.query,r=t.isHighlighted,o=Ve(e.label,n),s=Ye(e.label,o);return a.createElement(Ie.a,{selected:r,component:"div"},a.createElement("div",null,s.map(function(e,t){return e.highlight?a.createElement("span",{key:String(t),style:{fontWeight:300}},e.text):a.createElement("strong",{key:String(t),style:{fontWeight:500}},e.text)})))}function Xe(e){return e.label}function $e(e){var t=e.children;return a.createElement(Q.a,Object.assign({},e.containerProps,{square:!0}),t)}function Qe(e){var t=e.trim().toLowerCase(),n=t.length,a=0;return 0===n?[]:Ge.filter(function(e){var r=a<5&&e.label.toLowerCase().slice(0,n)===t;return r&&(a+=1),r})}function et(e){switch(e.type){case De.STORE:return a.createElement(Le.a,{title:e.reason},a.createElement(Be.a,null));default:return a.createElement(Le.a,{title:e.reason},a.createElement(Ze.a,null))}}function tt(e){if(e.field.mapping){var t=e.field.mapping,n=e.personas.filter(function(e){return t.personaAddress===e.hash});return n.length>0&&n[0].fields.filter(function(e){return e.name===t.personaFieldName}).length>0?a.createElement(S.a,{className:e.classes.persona},n[0].name+" - "+t.personaFieldName):a.createElement(S.a,{className:e.classes.persona},e.selectedPersona.name+" - "+e.field.name)}var r=Ge.filter(function(t){return t.field.name===e.field.name});return r.length>0?a.createElement(S.a,{className:e.classes.persona},r[0].persona.name+" - "+r[0].field.name):a.createElement(S.a,{className:e.classes.persona},e.selectedPersona.name+" - "+e.field.name)}var nt=function(e){function t(e){var n;return Object(w.a)(this,t),(n=Object(D.a)(this,Object(N.a)(t).call(this,e))).renderInput=function(e){var t=e.classes,r=e.ref,o=Object(Re.a)(e,["classes","ref"]);return a.createElement("div",null,a.createElement(M.a,{fullWidth:!0,id:"name",name:"name",label:n.props.field.displayName,InputProps:We({classes:{input:t.textfield},disableUnderline:!1,inputRef:r},o)}))},n.handleChange=function(e,t){var a=t.newValue,r=n.state.field,o=Ge.filter(function(e){return a===e.label});0===o.length?(t.newValue.length>0?r.mapping={personaAddress:n.props.selectedPersona.hash,personaFieldName:n.props.field.name}:r.mapping=void 0,n.setState({value:a,field:r})):(a=o[0].field.data,r.mapping={personaAddress:o[0].persona.hash,personaFieldName:o[0].field.name},n.setState({value:a,field:r}))},n.handleSuggestionsFetchRequested=function(e){var t=e.value;n.setState({suggestions:Qe(t)})},n.handleSuggestionsClearRequested=function(){n.setState({suggestions:[]})},n.handleMappingChange=function(){n.props.handleMappingChange(n.state.field,n.state.value)},n.state={selectedPersona:e.selectedPersona,suggestions:[],value:"",field:e.field},n}return Object(_.a)(t,e),Object(A.a)(t,[{key:"componentDidMount",value:function(){if(!this.props.field.mapping){var e=this.state.field,t=this.props.field.name,n=Ge.filter(function(e){return e.field.name===t});n.length>0?(e.mapping={personaAddress:n[0].persona.hash,personaFieldName:n[0].field.name},this.setState({value:n[0].field.data,field:e})):(e.mapping=void 0,this.setState({field:e}))}}},{key:"render",value:function(){var e=this.props,t=e.classes,n=e.field,r=e.profile,o=e.personas,s=e.selectedPersona;return a.createElement("div",{className:t.root},a.createElement(ze.a,{id:"selectedPersonaFieldValue",theme:{container:t.container,suggestion:t.suggestion,suggestionsContainerOpen:t.suggestionsContainerOpen,suggestionsList:t.suggestionsList},renderInputComponent:this.renderInput,suggestions:this.state.suggestions,onSuggestionsFetchRequested:this.handleSuggestionsFetchRequested,onSuggestionsClearRequested:this.handleSuggestionsClearRequested,renderSuggestionsContainer:$e,getSuggestionValue:Xe,renderSuggestion:Je,inputProps:{classes:t,onBlur:this.handleMappingChange,onChange:this.handleChange,value:this.state.value}}),a.createElement(et,{type:n.usage,reason:n.description,className:t.icon}),a.createElement(tt,{classes:t,profile:r,field:this.state.field,personas:o,selectedPersona:s}))}}],[{key:"getDerivedStateFromProps",value:function(e,t){if(Ge=[],e.personas.map(function(e){return e.fields.map(function(t){return Ge.push({persona:e,field:t,label:t.data+" ("+e.name+" - "+t.name+")"})})}),e.field.mapping){var n=e.field.mapping;if(e.selectedPersona!==t.selectedPersona)e.selectedPersona.fields.filter(function(e){return e.name===n.personaFieldName}).length>0&&(n.personaAddress=e.selectedPersona.hash);var a=e.personas.filter(function(e){return n.personaAddress===e.hash});if(a.length>0){var r=a[0].fields.filter(function(e){return e.name===n.personaFieldName});if(r.length>0)return{value:r[0].data}}}return null}}]),t}(a.Component),at=Object(z.a)(function(e){var t=e.spacing;return Object(H.a)({root:{width:"100%"},container:{flexGrow:1,position:"relative"},formControl:{background:"red"},inputLabel:{color:"#8d97a5",fontSize:12},menuItem:{fontFamily:"Roboto",fontSize:14,height:16},selectEmpty:{background:"#fff",marginTop:t(2)},suggestion:{display:"block"},suggestionsContainerOpen:{left:0,marginTop:t(1),position:"absolute",right:0,zIndex:1},suggestionsList:{listStyleType:"none",margin:0,padding:0},persona:{float:"right"}})})(nt);function rt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function ot(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?rt(n,!0).forEach(function(t){Object(l.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):rt(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var st=n(92),it=n(93),lt=[];function ct(e,t){var n=t.query,r=t.isHighlighted,o=st(e,n),s=it(e,o);return a.createElement(Ie.a,{selected:r,component:"div"},a.createElement("div",null,s.map(function(e,t){return e.highlight?a.createElement("span",{key:String(t),style:{fontWeight:300}},e.text):a.createElement("strong",{key:String(t),style:{fontWeight:500}},e.text)})))}function pt(e){return e}function ut(e){var t=e.children;return a.createElement(Q.a,Object.assign({},e.containerProps,{square:!0}),t)}function dt(e){var t=e.trim().toLowerCase(),n=t.length,a=0;return 0===n?[]:lt.filter(function(e){var r=a<5&&e.toLowerCase().slice(0,n)===t;return r&&(a+=1),r})}var ft=function(e){function t(e){var n;return Object(w.a)(this,t),(n=Object(D.a)(this,Object(N.a)(t).call(this,e))).handleMappingChange=function(e,t){n.props.handleMappingChange(e,t),n.setPersonaAndFieldName(e)},n.renderInput=function(e){var t=e.classes,n=e.ref,r=Object(Re.a)(e,["classes","ref"]);return a.createElement("div",null,a.createElement(M.a,{fullWidth:!0,id:"personaAutoText",name:"personaAutoText",label:"Persona Name",InputProps:ot({classes:{input:t.textfield},disableUnderline:!1,inputRef:n},r)}))},n.handleSuggestionsFetchRequested=function(e){var t=e.value;n.setState({suggestions:dt(t)})},n.handleSuggestionsClearRequested=function(){n.setState({suggestions:[]})},n.handlePersonaAutoChange=function(e,t){var a=t.newValue;n.setState({personaAutovalue:a})},n.handlePersonaAutoSelect=function(){},n.state={suggestions:[],personaAutovalue:e.selectedPersona.name,selectedPersona:e.selectedPersona,fieldAutovalue:"",expansionPanelOpen:!1,mappedPersona:e.selectedPersona,mappedField:e.field.name},n}return Object(_.a)(t,e),Object(A.a)(t,[{key:"componentDidMount",value:function(){void 0!==this.props.field.mapping&&this.setPersonaAndFieldName(this.props.field),lt=[],this.props.personas.map(function(e){return lt.push(e.name)})}},{key:"setPersonaAndFieldName",value:function(e){if(void 0!==e.mapping){var t=e.mapping,n=this.props.personas.filter(function(e){return t.personaAddress===e.hash});0!==n.length?this.setState({mappedPersona:n[0],mappedField:e.mapping.personaFieldName,personaAutovalue:n[0].name}):this.setState({mappedPersona:this.props.personas[0],personaAutovalue:this.props.personas[0].name})}else this.setState({personaAutovalue:this.props.selectedPersona.name})}},{key:"render",value:function(){var e=this,t=this.props,n=t.classes,r=t.field,o=t.personas,s=t.profile;return a.createElement("div",{className:n.root},a.createElement(xe.a,{expanded:this.state.expansionPanelOpen,style:{boxShadow:"none"}},a.createElement(Ke.a,{expandIcon:a.createElement(g.a,{name:"expandPersonaDetails",color:this.props.mapSaved?"primary":"secondary",onClick:function(){e.setState({expansionPanelOpen:!e.state.expansionPanelOpen})}})},a.createElement(at,{personas:o,selectedPersona:this.state.selectedPersona,profile:s,field:r,handleMappingChange:this.handleMappingChange})),a.createElement(Fe.a,null,a.createElement(ze.a,{id:"selectedPersonaValue",theme:{container:n.container,suggestion:n.suggestion,suggestionsContainerOpen:n.suggestionsContainerOpen,suggestionsList:n.suggestionsList},renderInputComponent:this.renderInput,suggestions:this.state.suggestions,onSuggestionsFetchRequested:this.handleSuggestionsFetchRequested,onSuggestionsClearRequested:this.handleSuggestionsClearRequested,renderSuggestionsContainer:ut,getSuggestionValue:pt,renderSuggestion:ct,inputProps:{classes:n,onBlur:this.handlePersonaAutoSelect,onChange:this.handlePersonaAutoChange,value:this.state.personaAutovalue}}),a.createElement(M.a,{className:n.field,name:"field",label:"Field",value:this.state.mappedField}))))}}],[{key:"getDerivedStateFromProps",value:function(e,t){if(e.selectedPersona!==t.selectedPersona){if(void 0!==e.field.mapping){var n=e.field.mapping;e.selectedPersona.fields.filter(function(e){return e.name===n.personaFieldName}).length>0&&(n.personaAddress=e.selectedPersona.hash);var a=e.personas.filter(function(e){return n.personaAddress===e.hash});return 0!==a.length?{selectedPersona:e.selectedPersona,mappedPersona:a[0],mappedField:e.field.mapping.personaFieldName,personaAutovalue:a[0].name}:{selectedPersona:e.selectedPersona,mappedPersona:e.personas[0],personaAutovalue:e.personas[0].name}}return{selectedPersona:e.selectedPersona,personaAutovalue:e.selectedPersona.name}}return null}}]),t}(a.Component),mt=I(Object(z.a)(function(e){var t=e.spacing;return Object(H.a)({root:{width:"100%"},container:{flexGrow:1,width:"50%"},field:{width:"50%"},inputLabel:{color:"#8d97a5",fontSize:12},menuItem:{fontFamily:"Roboto",fontSize:14,height:16},selectEmpty:{background:"#fff",marginTop:t(2)},suggestion:{display:"block"},suggestionsContainerOpen:{left:0,marginTop:t(1),position:"absolute",right:0,zIndex:1},suggestionsList:{listStyleType:"none",margin:0,padding:0}})})(ft)),ht=n(257),gt=function(e){function t(e){var n;return Object(w.a)(this,t),(n=Object(D.a)(this,Object(N.a)(t).call(this,e))).handleMappingChange=function(e,t){if(console.log("updatedField"),void 0!==e.mapping){var a=n.props.personas,r=e.mapping.personaAddress,o=e.mapping.personaFieldName,s=a.filter(function(e){return e.hash===r});if(1===s.length)0===s[0].fields.filter(function(e){return e.name===o}).length&&(s[0].fields.push({name:o,data:t}),n.setState({personas:a}))}n.state.profile.fields.filter(function(t){return t.name===e.name})[0]=e,n.setState({profile:n.state.profile})},n.handleSaveProfile=function(){n.props.save(n.state.profile,n.props.personas).then(n.props.getProfiles).then(function(){"/profiles"===n.props.returnUrl?n.props.history.push(n.props.returnUrl):window.location.replace(decodeURIComponent(n.props.returnUrl))}).catch(function(e){return console.log(e)})},n.handleChangeSelectedPersona=function(e){var t=e.target.value,a=n.props.personas.filter(function(e){return e.hash===t})[0];n.props.setCurrentPersona(a)},n.state={profile:e.profile,personas:e.personas},n}return Object(_.a)(t,e),Object(A.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.props.getPersonas({}).then(function(){return e.props.getProfiles({})}).catch(function(e){return console.log(JSON.stringify(e))})}},{key:"render",value:function(){var e=this;if(!this.props.selectedPersona||!this.props.profile)return a.createElement(ht.a,{container:!0,justify:"center"},a.createElement(Oe.a,null));var t=this.props,n=t.profile,r=t.classes;return a.createElement("div",{className:r.container},a.createElement(Q.a,{className:r.paper},a.createElement(S.a,{variant:"h4",component:"h2"},"Profile for ",n.name),a.createElement(S.a,{component:"p"},"Welcome to the Agent Centric Web where you are in control of your personal data."),a.createElement(Q.a,{className:r.selectContainer},a.createElement(M.a,{name:"PersonasSelect",className:r.select,select:!0,value:this.props.selectedPersona.hash,onChange:this.handleChangeSelectedPersona,label:"Selected Persona"},this.props.personas.map(function(e){return a.createElement(Ie.a,{key:e.hash,value:e.hash},e.name)}))),a.createElement(Q.a,{className:r.form},this.state.profile.fields.map(function(t,r){return a.createElement(mt,{key:r,personas:e.props.personas,selectedPersona:e.props.selectedPersona,profile:n,field:t,mapSaved:e.props.profile.fields[r].mapping,handleMappingChange:e.handleMappingChange})}),a.createElement(L.a,{id:"Agree",onClick:this.handleSaveProfile,color:"primary"},"Save Profile"))))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return t.profile?null:{profile:e.profile}}}]),t}(a.Component),yt=I(Object(z.a)(function(e){var t=e.spacing;return Object(H.a)({container:{flexGrow:1,position:"relative"},button:{marginRight:t(1),marginTop:t(1),marginLeft:25,marginBottom:25},selectContainer:{paddingTop:10,paddingBottom:10,paddingLeft:25,paddingRight:25,width:"100%",marginBottom:25},select:{width:"100%"},paper:{padding:t(1)}})})(Object(c.e)(gt)));function bt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function vt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?bt(n,!0).forEach(function(t){Object(l.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):bt(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var Ot=Object(s.b)(function(e,t){var n,a="/profiles";if(t.match){var r=t.match.params.hash;n=e.personasProfiles.profile.profiles.filter(function(e){return console.log(e.sourceDna===r),e.sourceDna===r})[0],a=t.match.params.returnUrl?t.match.params.returnUrl:"/profiles",console.log("returnUrl "+a)}else n=e.personasProfiles.profile.currentProfile;return{returnUrl:a,personas:e.personasProfiles.profile.personas,selectedPersona:e.personasProfiles.profile.currentPersona,profile:n}},function(e){return{getProfiles:function(){return e(pe.create({}))},getPersonas:function(){return e(le.create({}))},setCurrentPersona:function(t){e(de(t))},save:function(t,n){return console.log("About to map ",t),Promise.all(t.fields.filter(function(e){return e.mapping}).map(function(a){var r=[];if(console.log("add the persona field for ",a.displayName),void 0!==a.mapping){var o=a.mapping.personaAddress,s=a.mapping.personaFieldName,i=n.filter(function(e){return e.hash===o});if(1===i.length){var l=i[0].fields.filter(function(e){return e.name===s});if(1===l.length){var c=l[0];r.push(e(ce.create({persona_address:o,field:c})))}}}return console.log("creating map for ",a),r.push(e(ue.create({mapping:vt({},a.mapping,{retrieverDna:t.sourceDna,profileFieldName:a.name})}))),Promise.all(r)}))}}})(yt),Et=function(e){function t(){return Object(w.a)(this,t),Object(D.a)(this,Object(N.a)(t).apply(this,arguments))}return Object(_.a)(t,e),Object(A.a)(t,[{key:"componentDidMount",value:function(){this.props.getProfiles({}).catch(function(e){console.log(JSON.stringify(e))})}},{key:"render",value:function(){var e=this.props,t=e.classes,n=e.profiles;return a.createElement("div",{className:t.root},a.createElement(Q.a,{className:t.paper},a.createElement(S.a,{variant:"h4"},"Profiles"),a.createElement(S.a,{variant:"body1",gutterBottom:!0},"Each time an app asks for Profile Information it gets stored here so you can see exactly what your information is being used for."),a.createElement(y.a,null,n.map(function(e,t){return a.createElement(c.a,{key:t,render:function(t){var n=t.history;return a.createElement(b.a,{button:!0,onClick:function(){n.push("/profile/".concat(e.sourceDna))}},a.createElement(O.a,{primary:e.name}))}})}))))}}]),t}(a.Component),Pt=I(Object(z.a)(function(e){var t=e.spacing;return Object(H.a)({root:{textAlign:"left",paddingTop:t(1)},paper:{padding:t(1)}})})(Et)),jt=Object(s.b)(function(e){return{profiles:e.personasProfiles.profile.profiles}},function(e){return{getProfiles:function(){return e(pe.create({}))}}})(Pt),St=n(258),kt=n(259),Ct=n(260);var wt=I(Object(z.a)(function(e){e.palette;return Object(H.a)({card:{minWidth:300},media:{height:0,paddingTop:"56.25%"},actions:{display:"flex"},title:{fontSize:8,marginTop:10}})})(function(e){var t=e.currentKey,n=e.classes,r=e.keyType,o=e.address,s=e.updateKey,i=function(t,n){(0,e[t])(n).catch(function(e){console.log("HC ZOMECALL ERROR = action, result : ",t,JSON.stringify(e))})};return a.createElement(B.a,{className:n.card},a.createElement(St.a,{title:"".concat(function(e){var t=e.replace(/([A-Z])/g," $1").trim();return t[0].toUpperCase()+t.substr(1)}(r)),titleTypographyProps:{variant:"h6"},subheader:"".concat(o),subheaderTypographyProps:{variant:"body2"}}),a.createElement("hr",{style:{margin:"5px auto",width:"95%"}}),a.createElement(U.a,{className:n.actions},a.createElement(L.a,{size:"small",color:"primary",onClick:function(){"revocationKey"===r?i("updateRevocationRules",{revocationKey:o,signedOldRevocationKey:t.priorRevocationSelfSig}):"authorizationKey"===r?i("setAuthorizer",{authorizationKeyPath:1,signedAuthKey:"how_do_we_determine_this????"}):(s({oldKey:o,signedOldKey:"IS_THIS_THE_REV_KEY_Signature_????",context:t.context}),i("updateKey",{oldKey:o,signedOldKey:"IS_THIS_THE_REV_KEY_Signature_????",context:t.context}))}},a.createElement(kt.a,null),"Replace"),a.createElement(L.a,{size:"small",color:"primary",onClick:function(){"revocationKey"===r?console.log("Trying to delete a revocation key. This is not possible. Please update/replace key instead."):"authorizationKey"===r?console.log("Trying to delete a authorization key. This is not possible. Please update/replace key instead."):i("deleteKey",{oldKey:o,signedOldKey:"IS_THIS_THE_REV_KEY_Signature_????"})}},a.createElement(Ct.a,null),"Delete")))})),At=function(e){function t(){return Object(w.a)(this,t),Object(D.a)(this,Object(N.a)(t).apply(this,arguments))}return Object(_.a)(t,e),Object(A.a)(t,[{key:"render",value:function(){var e=this.props,t=e.classes,n=e.revocationRuleSet,r=e.isInitialized,o=e.allKeys;return a.createElement("div",{className:t.root},a.createElement(Q.a,{className:t.paper},a.createElement(S.a,{variant:"h4"},"DeepKey"),a.createElement(S.a,{variant:"body1",gutterBottom:!0},"All DeepKey Information is stored here, so you can keep track of your device seeds/keys and know exactly which devices are secured."),a.createElement("hr",null),r?a.createElement(S.a,{variant:"subtitle1",gutterBottom:!0},"DeepKey is Initialized"):r&&n?a.createElement("div",null,a.createElement(S.a,{variant:"subtitle1",gutterBottom:!0},"Available Keys"),a.createElement(wt,{address:n.revocationKey,keyType:"revocationKey"})):r&&n&&o?a.createElement(y.a,null,o.map(function(e,t){return a.createElement(c.a,{key:"".concat(t,"-deepkey"),render:function(n){var r=n.history;return a.createElement(b.a,{key:t,button:!0,onClick:function(){r.push("/deepkey/".concat(e.keyType))}},a.createElement(O.a,{primary:e.keyType}),a.createElement(wt,{address:e.address,keyType:e.keyType}))}})})):r&&n&&!o?a.createElement(S.a,{variant:"subtitle1",gutterBottom:!0},"No Keys Currently Available"):a.createElement("main",null,a.createElement(S.a,{variant:"subtitle1",gutterBottom:!0},"Warning: Your DeepKey is Not Initialized."),a.createElement(S.a,{variant:"subtitle2",gutterBottom:!0},"Please ensure your conductor is correctly configured with DeepKey and running."))))}}]),t}(a.Component),Dt=I(Object(z.a)(function(e){var t=e.spacing;return Object(H.a)({root:{textAlign:"left",paddingTop:t(1)},paper:{padding:t(1)}})})(At)),Nt=Object(J.createHolochainZomeCallAsyncAction)("dpki_happ","dpki","is_initialized"),_t=Object(J.createHolochainZomeCallAsyncAction)("dpki_happ","dpki","get_rules"),Tt=(Object(J.createHolochainZomeCallAsyncAction)("dpki_happ","dpki","update_rules"),Object(J.createHolochainZomeCallAsyncAction)("dpki_happ","dpki","set_authorizor"),Object(J.createHolochainZomeCallAsyncAction)("dpki_happ","dpki","get_authorizor")),Rt=Object(J.createHolochainZomeCallAsyncAction)("dpki_happ","dpki","get_all_keys"),xt=Object(J.createHolochainZomeCallAsyncAction)("dpki_happ","dpki","update_key"),Kt=Object(J.createHolochainZomeCallAsyncAction)("dpki_happ","dpki","delete_key"),Ft=(Object(J.createHolochainZomeCallAsyncAction)("admin","agent","add"),Object(J.createHolochainZomeCallAsyncAction)("admin","agent","list"),Object(s.b)(function(e){return{isInitialized:e.deepKey.isInitialized,revocationRuleSet:e.deepKey.revocationRuleSet,authorizerKeySet:e.deepKey.authorizerKeySet,allKeys:e.deepKey.deepkey.allKeys}},function(e){return{fetchIsInitialized:function(){return e(Nt.create({}))},fetchRevocationRules:function(){return e(_t.create({}))},fetchAuthorizer:function(){return e(Tt.create({}))},fetchAllKeys:function(){return e(Rt.create({}))},updateKey:function(t){return e(xt.create(t))},deleteKey:function(t){return e(Kt.create(t))}}})(Dt)),It=Object(k.a)(function(e){return{root:{display:"flex"},drawer:Object(l.a)({},e.breakpoints.up("sm"),{width:240,flexShrink:0}),appBar:Object(l.a)({marginLeft:240},e.breakpoints.up("sm"),{width:"calc(100% - ".concat(240,"px)")}),menuButton:Object(l.a)({marginRight:e.spacing(2)},e.breakpoints.up("sm"),{display:"none"}),toolbar:e.mixins.toolbar,drawerPaper:{width:240},content:{flexGrow:1,padding:e.spacing(3)}}});var Ht=function(e){var t=e.container,n=It(),a=Object(C.a)(),o=r.a.useState(!1),s=Object(i.a)(o,2),l=s[0],h=s[1];function E(){h(!l)}function k(e,t){e.push(t),h(!l)}var w=r.a.createElement("div",null,r.a.createElement("div",{className:n.toolbar}),r.a.createElement(y.a,null,r.a.createElement(c.a,{render:function(e){var t=e.history;return r.a.createElement("div",null,r.a.createElement(b.a,{button:!0,onClick:function(){k(t,"/deepkey")}},r.a.createElement(v.a,null,r.a.createElement(g.a,null)),r.a.createElement(O.a,{primary:"Deep Key"})),r.a.createElement(b.a,{button:!0,onClick:function(){k(t,"/personas")}},r.a.createElement(v.a,null,r.a.createElement(g.a,null)),r.a.createElement(O.a,{primary:"Personas"})),r.a.createElement(b.a,{button:!0,onClick:function(){k(t,"/profiles")}},r.a.createElement(v.a,null,r.a.createElement(g.a,null)),r.a.createElement(O.a,{primary:"Profiles"})),r.a.createElement(b.a,{button:!0,onClick:function(){k(t,"/login")}},r.a.createElement(v.a,null,r.a.createElement(g.a,null)),r.a.createElement(O.a,{primary:"Login"})))}})));return r.a.createElement("div",{className:n.root},r.a.createElement(u.a,null),r.a.createElement(p.a,{position:"fixed",className:n.appBar},r.a.createElement(j.a,null,r.a.createElement(m.a,{color:"inherit","aria-label":"open drawer",edge:"start",onClick:E,className:n.menuButton},r.a.createElement(P.a,null)),r.a.createElement(S.a,{variant:"h6",noWrap:!0},"Holochain Identity Manager"))),r.a.createElement("nav",{className:n.drawer,"aria-label":"mailbox folders"},r.a.createElement(f.a,{smUp:!0,implementation:"css"},r.a.createElement(d.a,{container:t,variant:"temporary",anchor:"rtl"===a.direction?"right":"left",open:l,onClose:E,classes:{paper:n.drawerPaper},ModalProps:{keepMounted:!0}},w)),r.a.createElement(f.a,{xsDown:!0,implementation:"css"},r.a.createElement(d.a,{classes:{paper:n.drawerPaper},variant:"permanent",open:!0},w))),r.a.createElement("main",{className:n.content},r.a.createElement("div",{className:n.toolbar}),r.a.createElement(c.a,{exact:!0,path:"/login",title:"Holo",render:function(e){return r.a.createElement("div",null,r.a.createElement($,e))}}),r.a.createElement(c.a,{path:"/personas",component:me}),r.a.createElement(c.a,{path:"/persona/:name",component:Te}),r.a.createElement(c.a,{path:"/profiles",component:jt}),r.a.createElement(c.a,{exact:!0,path:"/profile/:hash",render:function(e){return r.a.createElement(Ot,e)}}),r.a.createElement(c.a,{exact:!0,path:"/profile/:hash/:returnUrl",render:function(e){return r.a.createElement(Ot,e)}}),r.a.createElement(c.a,{path:"/deepkey",component:Ft}),r.a.createElement(c.a,{exact:!0,path:"/",render:function(e){return r.a.createElement("div",null,r.a.createElement(me,e),r.a.createElement(jt,e),r.a.createElement(Ft,e))}})))},zt=n(40),Lt=function(e){var t=e.store;return a.createElement(s.a,{store:t},a.createElement(zt.a,null,a.createElement(c.a,{path:"/",component:Ht})))},Mt=n(29),Bt=n(83);function Ut(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}var Zt={loggedIn:!1};var qt=Object(Mt.c)({login:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Zt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Object(re.getType)(X.success):return console.log(t),function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ut(n,!0).forEach(function(t){Object(l.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ut(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},e,{loggedIn:t.payload});default:return e}}});function Wt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function Vt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Wt(n,!0).forEach(function(t){Object(l.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Wt(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var Yt={profiles:[],currentProfile:void 0,personas:[],currentPersona:void 0};var Gt=Object(Mt.c)({profile:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Yt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Object(re.getType)(le.success):console.log(t);var n=t.payload.map(function(e){return Vt({},e.entry,{hash:e.address})}),a=n.filter(function(e){return"Default"===e.name})[0]||n[0]||void 0;return Vt({},e,{personas:n,currentPersona:a});case Object(re.getType)(pe.success):return Vt({},e,{profiles:t.payload.map(function(e){var t=e.fields.map(function(e){return Vt({},e,{mapping:e.mapping?e.mapping:void 0})});return Vt({},e,{fields:t})})});case Object(re.getType)(de):return Vt({},e,{currentPersona:t.payload});case Object(re.getType)(fe):return Vt({},e,{currentProfile:t.payload});default:return e}}});function Jt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function Xt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Jt(n,!0).forEach(function(t){Object(l.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Jt(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var $t={isInitialized:!1,revocationRuleSet:void 0,authorizerKeySet:void 0,allKeys:[]};var Qt,en=Object(Mt.c)({deepkey:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:$t,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Object(re.getType)(Nt.success):return console.log("Is DeepKey initialized ?? : ",t.payload),Xt({},e,{isInitialized:t.payload});case Object(re.getType)(_t.success):return console.log("get GetrevocationRuleSet : ",t.payload),Xt({},e,{revocationRuleSet:t.payload[0].entry});case Object(re.getType)(Tt.success):return console.log("get Authorizer : ",t.payload),Xt({},e,{AuthorizerKeySet:t.payload[0].entry});case Object(re.getType)(Rt.success):return console.log("get all keys : ",t.payload),Xt({},e,{allKeys:t.payload});default:return e}}}),tn=Object({NODE_ENV:"production",PUBLIC_URL:""}).REACT_APP_CHAT_WEBSOCKET_INTERFACE,nn=Object(Mt.c)({login:qt,personasProfiles:Gt,deepKey:en});Qt=tn?[Object(J.holochainMiddleware)(Object(Bt.connect)({url:tn}))]:[Object(J.holochainMiddleware)(Object(Bt.connect)())];var an=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||Mt.d;var rn=function(){return Object(Mt.e)(nn,an(Mt.a.apply(void 0,Object(he.a)(Qt))))}();o.render(a.createElement(Lt,{store:rn}),document.querySelector("#root"))}},[[132,1,2]]]);
//# sourceMappingURL=main.23280086.chunk.js.map